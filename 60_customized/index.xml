<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>边缘计算 on Funny Edge Workshop</title><link>http://funnyedge.svhw.tech/60_customized/</link><description>Recent content in 边缘计算 on Funny Edge Workshop</description><generator>Hugo -- gohugo.io</generator><language>en-us</language><lastBuildDate>Tue, 12 Apr 2022 14:13:47 +0800</lastBuildDate><atom:link href="http://funnyedge.svhw.tech/60_customized/index.xml" rel="self" type="application/rss+xml"/><item><title>根据客户端所在国家选择源站</title><link>http://funnyedge.svhw.tech/60_customized/10_multi_origin/</link><pubDate>Tue, 12 Apr 2022 14:22:31 +0800</pubDate><guid>http://funnyedge.svhw.tech/60_customized/10_multi_origin/</guid><description>0. 打开CloudShell https://console.aws.amazon.com/cloudshell/home
CloudShell在浏览器上提供了一个运行各种aws命令行工具的的shell环境，使得你可以非常简单的使用命令管理和操作AWS资源。CloudShell直接继承登陆控制台用户的权限，无需额外使用AKSK，从而避免了AKSK泄露的风险。
小技巧：在控制台右上角的“操作”菜单,通过上传和下载文件可进行本地和CloudShell之间的文件传输。
1. 创建Lambda@Edge函数 1.1 创建策略
# 定义角色信任策略文档：该策略将用于创建一个角色，并且允许Lambda及Lambda@Edge切换至该角色 cat &amp;lt;&amp;lt;EoF &amp;gt; lambdaedge-assume-role-policy.json { &amp;quot;Version&amp;quot;: &amp;quot;2012-10-17&amp;quot;, &amp;quot;Statement&amp;quot;: [ { &amp;quot;Effect&amp;quot;: &amp;quot;Allow&amp;quot;, &amp;quot;Principal&amp;quot;: { &amp;quot;Service&amp;quot;: [ &amp;quot;edgelambda.amazonaws.com&amp;quot;, &amp;quot;lambda.amazonaws.com&amp;quot; ] }, &amp;quot;Action&amp;quot;: &amp;quot;sts:AssumeRole&amp;quot; } ] } EoF # 创建角色并将其ARN保存在环境变量 ROLE_NAME=lambda-edge-multi-origin-role ROLE_ARN=$(aws iam create-role --role-name $ROLE_NAME --assume-role-policy-document file://lambdaedge-assume-role-policy.json --query Role.Arn --no-cli-pager --output text) echo $ROLE_ARN # 定义权限策略文档：该策略将允许上述角色往所有区域的cloudwatch写入日志 cat &amp;lt;&amp;lt;EoF &amp;gt; lambdaedge-write-cloudwatch-log-policy.json { &amp;quot;Version&amp;quot;: &amp;quot;2012-10-17&amp;quot;, &amp;quot;Statement&amp;quot;: [ { &amp;quot;Effect&amp;quot;: &amp;quot;Allow&amp;quot;, &amp;quot;Action&amp;quot;: [ &amp;quot;logs:CreateLogGroup&amp;quot;, &amp;quot;logs:CreateLogStream&amp;quot;, &amp;quot;logs:PutLogEvents&amp;quot; ], &amp;quot;Resource&amp;quot;: [ &amp;quot;arn:aws:logs:*:*:*&amp;quot; ] } ] } EoF # 创建策略并将其ARN保存在环境变量 POLICY_ARN=$(aws iam create-policy --policy-name LambdaEdgeWriteCloudWatchLogPolicy --policy-document file://lambdaedge-write-cloudwatch-log-policy.</description></item></channel></rss>