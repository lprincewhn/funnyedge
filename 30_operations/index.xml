<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>运维管理 on Funny Edge Workshop</title><link>http://funnyedge.svhw.tech/30_operations/</link><description>Recent content in 运维管理 on Funny Edge Workshop</description><generator>Hugo -- gohugo.io</generator><language>en-us</language><lastBuildDate>Tue, 12 Apr 2022 14:13:47 +0800</lastBuildDate><atom:link href="http://funnyedge.svhw.tech/30_operations/index.xml" rel="self" type="application/rss+xml"/><item><title>利用标签进行权限限制和费用分摊</title><link>http://funnyedge.svhw.tech/30_operations/10_tag/</link><pubDate>Tue, 12 Apr 2022 14:32:23 +0800</pubDate><guid>http://funnyedge.svhw.tech/30_operations/10_tag/</guid><description>0. 打开CloudShell https://console.aws.amazon.com/cloudshell/home
CloudShell在浏览器上提供了一个运行各种aws命令行工具的的shell环境，使得你可以非常简单的使用命令管理和操作AWS资源。CloudShell直接继承登陆控制台用户的权限，无需额外使用AKSK，从而避免了AKSK泄露的风险。
小技巧：在控制台右上角的“操作”菜单,通过上传和下载文件可进行本地和CloudShell之间的文件传输。
# 下载并解压AutoOps软件包 cd ~ wget https://github.com/lprincewhn/AutoOps/archive/refs/tags/v0.9.0-alpha.220423.zip unzip v0.9.0-alpha.220423.zip 1. 创建CloudTrail跟踪 通过以下命令部署AutoOps通用运维组件，包括：
一个SNS主题，用于发送事件通知 一个S3桶，用于存放CloudTrail跟踪文件 一个CloudTrail跟踪，监控本账号所有区域的管理事件，创建跟踪后，可以通过EventBridge监控API调用事件 cd ~/AutoOps-0.9.0-alpha.220423/Common MAIN_REGION=us-east-1 sam build sam deploy --stack-name AutoOpsCommon --region $MAIN_REGION --confirm-changeset --resolve-s3 --capabilities CAPABILITY_IAM 部署过程中，屏幕将会提示本次部署所需要创建/更新/删除的组件，确认后输入“y“-&amp;gt;“回车”继续完成部署。
2. 部署CloudFront自动配置流程 该流程将通过EventBridge侦听CloudFront分配的创建，修改和删除事件，对分配的标签和告警进行配置。流程图如下：
标签包括：
将分配的“备用域名”拷贝到分配的DomainName标签中 将操作用户的用户名或角色名称拷贝到分配的Owner标签中 将操作用户的特定标签（默认为Project和Team）拷贝到分配的相应标签中 告警包括：
5xx错误率&amp;gt;5% 请求次数突降&amp;gt;80% 命令如下：
cd ~/AutoOps-0.9.0-alpha.220423/CloudFrontProvision REGION=us-east-1 cp workflows/state.asl.all.json state.asl.json sam build sam deploy --stack-name AutoOpsCloudFrontProvision --region $REGION --confirm-changeset --resolve-s3 --capabilities CAPABILITY_IAM 部署过程中，屏幕将会提示本次部署所需要创建/更新/删除的组件，确认后输入“y“-&amp;gt;“回车”继续完成部署。</description></item><item><title>证书过期提醒</title><link>http://funnyedge.svhw.tech/30_operations/20_certificate_expire/</link><pubDate>Tue, 12 Apr 2022 14:32:23 +0800</pubDate><guid>http://funnyedge.svhw.tech/30_operations/20_certificate_expire/</guid><description>&amp;lt;敬请期待&amp;gt;</description></item></channel></rss>